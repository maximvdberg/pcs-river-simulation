
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
import numpy as np

viscosity = 0.01
u_slope = (0.1, 0.0)
u0 = ...
delta_x = 1.0
delta_t = 1.0
rho0 = 1.0


u2 = [0.00047074, 0.00140883, 0.00234017, 0.00326489, 0.00418333, 0.00509601, 0.00600349, 0.00690637, 0.00780517, 0.00870033, 0.00959214, 0.0104808, 0.0113664, 0.012249, 0.0131284, 0.0140045, 0.0148772, 0.0157463, 0.0166117, 0.0174731, 0.0183303, 0.0191833, 0.0200317, 0.0208755, 0.0217144, 0.0225483, 0.0233771, 0.0242005, 0.0250185, 0.0258308, 0.0266373, 0.0274378, 0.0282322, 0.0290203, 0.029802, 0.0305772, 0.0313456, 0.0321071, 0.0328617, 0.0336091, 0.0343492, 0.0350819, 0.035807, 0.0365244, 0.0372341, 0.0379358, 0.0386294, 0.0393148, 0.039992, 0.0406607, 0.0413209, 0.0419725, 0.0426154, 0.0432493, 0.0438744, 0.0444904, 0.0450973, 0.0456949, 0.0462832, 0.0468621, 0.0474315, 0.0479913, 0.0485415, 0.0490819, 0.0496126, 0.0501333, 0.0506441, 0.0511449, 0.0516356, 0.0521162, 0.0525865, 0.0530466, 0.0534964, 0.0539357, 0.0543647, 0.0547832, 0.0551912, 0.0555886, 0.0559754, 0.0563515, 0.056717, 0.0570717, 0.0574156, 0.0577488, 0.0580711, 0.0583826, 0.0586831, 0.0589728, 0.0592515, 0.0595192, 0.0597759, 0.0600216, 0.0602563, 0.0604799, 0.0606924, 0.0608939, 0.0610842, 0.0612634, 0.0614315, 0.0615884, 0.0617342, 0.0618687, 0.0619921, 0.0621043, 0.0622053, 0.0622951, 0.0623737, 0.0624411, 0.0624972, 0.0625421, 0.0625758, 0.0625983, 0.0626095, 0.0626095, 0.0625982, 0.0625757, 0.062542, 0.062497, 0.0624408, 0.0623734, 0.0622948, 0.062205, 0.0621039, 0.0619917, 0.0618682, 0.0617336, 0.0615878, 0.0614309, 0.0612627, 0.0610835, 0.0608931, 0.0606916, 0.0604791, 0.0602554, 0.0600207, 0.059775, 0.0595182, 0.0592504, 0.0589717, 0.058682, 0.0583814, 0.05807, 0.0577476, 0.0574144, 0.0570704, 0.0567157, 0.0563502, 0.055974, 0.0555872, 0.0551898, 0.0547818, 0.0543633, 0.0539343, 0.0534949, 0.0530451, 0.052585, 0.0521146, 0.0516341, 0.0511433, 0.0506426, 0.0501317, 0.049611, 0.0490803, 0.0485399, 0.0479897, 0.0474299, 0.0468605, 0.0462815, 0.0456932, 0.0450956, 0.0444887, 0.0438727, 0.0432477, 0.0426137, 0.0419709, 0.0413193, 0.0406591, 0.0399904, 0.0393132, 0.0386278, 0.0379342, 0.0372325, 0.0365229, 0.0358055, 0.0350803, 0.0343477, 0.0336076, 0.0328602, 0.0321057, 0.0313442, 0.0305758, 0.0298007, 0.029019, 0.0282309, 0.0274365, 0.026636, 0.0258295, 0.0250173, 0.0241994, 0.023376, 0.0225472, 0.0217133, 0.0208744, 0.0200307, 0.0191823, 0.0183294, 0.0174722, 0.0166108, 0.0157455, 0.0148764, 0.0140038, 0.0131277, 0.0122483, 0.0113658, 0.0104803, 0.00959164, 0.00869987, 0.00780477, 0.00690601, 0.00600318, 0.00509574, 0.00418311, 0.00326472, 0.00234004, 0.00140876, 0.000470715]

#u2 = [0.0181175, 0.0373399, 0.0551884, 0.0716536, 0.0866563, 0.100117, 0.111978, 0.122254, 0.131013, 0.138366, 0.144446, 0.149393, 0.153345, 0.15644, 0.158804, 0.160555, 0.161798, 0.162624, 0.163111, 0.163325, 0.163321, 0.163144, 0.162831, 0.16241, 0.161906, 0.161335, 0.160711, 0.160044, 0.159339, 0.158599, 0.157825, 0.157013, 0.156158, 0.155248, 0.154273, 0.153213, 0.152047, 0.150747, 0.14928, 0.147607, 0.145682, 0.143453, 0.140861, 0.13784, 0.134323, 0.130234, 0.125499, 0.120045, 0.1138, 0.106706, 0.0987133, 0.0897839, 0.0798805, 0.0689593, 0.0569629, 0.0438284, 0.0294925, 0.0139148, ]

# Omega  v= 0.005
#u2 = [0.0258561, 0.0568558, 0.0885507, 0.115825, 0.135519, 0.148617, 0.156215, 0.160334, 0.16218, 0.162761, 0.16262, 0.162126, 0.16137, 0.160629, 0.15982, 0.158954, 0.158175, 0.157315, 0.156517, 0.155728, 0.154945, 0.154135, 0.153385, 0.152633, 0.15186, 0.151135, 0.150415, 0.149675, 0.148975, 0.148277, 0.147577, 0.146905, 0.146226, 0.145565, 0.144907, 0.144257, 0.14362, 0.143003, 0.142364, 0.141765, 0.141147, 0.14056, 0.13995, 0.139357, 0.138754, 0.13814, 0.137413, 0.136489, 0.135175, 0.133201, 0.129975, 0.124854, 0.116853, 0.105044, 0.0886625, 0.0679107, 0.0436605, 0.0175948, ]

# Omega v = 0.001
#u2 = [0.0316473, 0.0733748, 0.117727, 0.135354, 0.142988, 0.152413, 0.14792, 0.14595, 0.150591, 0.146546, 0.150596, 0.154977, 0.148345, 0.145303, 0.147656, 0.152024, 0.149155, 0.144575, 0.148324, 0.14806, 0.14618, 0.143345, 0.145515, 0.146128, 0.142441, 0.141709, 0.143457, 0.141813, 0.139911, 0.140611, 0.140272, 0.138335, 0.137672, 0.138813, 0.137776, 0.134621, 0.135641, 0.136725, 0.135187, 0.132923, 0.133039, 0.134142, 0.132313, 0.131351, 0.130897, 0.131632, 0.130349, 0.129532, 0.128452, 0.128924, 0.128548, 0.127576, 0.126632, 0.125738, 0.119805, 0.0970397, 0.0604517, 0.0201464, ]

#omega 0.01
#u2 = [0.0191841, 0.0414685, 0.0643171, 0.0862629, 0.105733, 0.121772, 0.134164, 0.143269, 0.149559, 0.153708, 0.156227, 0.157624, 0.158232, 0.158291, 0.158038, 0.157552, 0.156936, 0.156247, 0.155516, 0.154754, 0.153997, 0.153235, 0.152473, 0.151723, 0.150983, 0.150246, 0.149521, 0.148809, 0.148102, 0.147404, 0.146718, 0.14604, 0.145369, 0.144708, 0.144054, 0.143409, 0.142768, 0.142132, 0.141492, 0.140848, 0.140176, 0.139466, 0.13867, 0.137742, 0.136595, 0.135117, 0.133132, 0.130435, 0.12674, 0.121738, 0.115069, 0.106403, 0.0954958, 0.0822987, 0.0669721, 0.0498766, 0.0315558, 0.0128972, ]

#lambda binnen
#u2 =[0.0177684, 0.0673653, 0.122741, 0.162876, 0.178498, 0.183396, 0.184894, 0.185319, 0.183434, 0.180929, 0.178731, 0.176325, 0.173355, 0.170473, 0.16787, 0.165187, 0.162417, 0.159824, 0.157383, 0.154946, 0.15257, 0.15033, 0.148171, 0.146057, 0.144028, 0.14209, 0.140206, 0.138383, 0.136637, 0.134952, 0.133316, 0.131741, 0.130225, 0.128756, 0.127332, 0.125958, 0.124627, 0.123328, 0.122062, 0.120826, 0.119607, 0.118396, 0.117187, 0.115965, 0.114712, 0.11341, 0.112039, 0.110571, 0.108977, 0.107225, 0.105285, 0.103123, 0.100712, 0.0980291, 0.095062, 0.0918079, 0.0882755, 0.0844845, 0.080463, 0.0762434, 0.0718581, 0.0673392, 0.0627156, 0.0580121, 0.0532503, 0.0484542, 0.0436486, 0.0388604, 0.0341222, 0.029481, 0.0249952, 0.0207486, 0.0168777, 0.0136218, 0.0113625, 0.010559, 0.0113242, 0.0132013, 0.0156462, 0.0183012, 0.0209856, 0.0235917, 0.0261024, 0.028464, 0.0306549, 0.0326005, 0.0341917, 0.035165, 0.0351603, 0.0335888, 0.0296679, 0.0224583, 0.0110226, ]

# river3 v = 0.01, u0=0.1, x only
#u2 = [0.00888361, 0.0218282, 0.0341482, 0.0457931, 0.0564907, 0.0658157, 0.0735309, 0.0796424, 0.0843888, 0.0880839, 0.0910088, 0.0933811, 0.0953637, 0.097045, 0.098504, 0.0997861, 0.100936, 0.101983, 0.102958, 0.103878, 0.104764, 0.105621, 0.106457, 0.107271, 0.108059, 0.108803, 0.10949, 0.110088, 0.110559, 0.110849, 0.110899, 0.110607, 0.109853, 0.108477, 0.106242, 0.102843, 0.097947, 0.0912147, 0.0823632, 0.0713668, 0.0585539, 0.0446135, 0.0307544, 0.0182134, 0.00785, ]

# river 3 v = 0.01, u0=.1, x only
#u2 = [0.0698369, 0.139468, 0.193497, 0.231282, 0.253677, 0.266931, 0.272778, 0.275075, 0.275586, 0.274155, 0.27288, 0.270586, 0.268626, 0.266437, 0.264221, 0.262102, 0.259849, 0.257696, 0.255618, 0.253469, 0.25148, 0.249504, 0.247506, 0.245619, 0.243762, 0.241869, 0.24009, 0.238326, 0.236563, 0.234796, 0.233093, 0.23125, 0.229596, 0.22759, 0.225644, 0.223448, 0.220913, 0.217497, 0.212608, 0.204944, 0.192819, 0.173469, 0.144538, 0.103037, 0.048288, ]

# river 2, v=0.001, u0=0.05, x only
#u2 = [0.026024, 0.053465, 0.0721717, 0.0780624, 0.079152, 0.0783645, 0.0779268, 0.0775129, 0.0763635, 0.0761432, 0.0749451, 0.0745797, 0.0737996, 0.0731391, 0.0728064, 0.0719292, 0.071662, 0.0707508, 0.0702584, 0.06982, 0.0689682, 0.0687378, 0.0681424, 0.0674682, 0.0672322, 0.0664847, 0.0660726, 0.0656749, 0.0651927, 0.064466, 0.0644092, 0.0637706, 0.0634636, 0.0630397, 0.0624883, 0.0621236, 0.0617372, 0.0614228, 0.0609414, 0.0606928, 0.0600028, 0.059053, 0.0532095, 0.0394369, 0.0181834, ]


print(len(u2))
x = np.linspace(0.0, 1.0, len(u2))


f = lambda x, h, p_grad : p_grad * (h - x) * x / viscosity

popt, pcov = curve_fit(f, x, u2)

plt.plot(u2, x)
plt.plot(f(x, *popt), x, linestyle='--')
plt.grid()
plt.ylabel("$y/h$")
plt.xlabel("Flow speed $|u|$ ($m s^{-1}$)")
plt.xlim(0, max(u2)*1.1)
plt.ylim(x[0], x[-1])
plt.show()


